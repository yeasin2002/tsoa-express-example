# TSOA Todo API

A minimal **TypeScript + Express + TSOA** example demonstrating **automatic OpenAPI generation** from TypeScript decorators.  
This project shows how TSOA bridges type-safe TypeScript code with OpenAPI documentation and runtime route generation.

---

## What is TSOA?

**TSOA** (TypeScript OpenAPI) is a framework that:
- Generates OpenAPI specs directly from TypeScript decorators
- Creates Express/Koa routes automatically from controller classes
- Ensures runtime validation matches TypeScript types
- Eliminates manual API documentation maintenance

Instead of writing routes and docs separately, you write **decorated controller classes** and TSOA handles the rest.

---

## How TSOA Works

### 1. Define Models (TypeScript Interfaces)

```typescript
// src/models/todo.ts
export interface Todo {
  id: number;
  title: string;
  completed: boolean;
}
```

### 2. Create Controllers with Decorators

```typescript
// src/controllers/todo.controller.ts
import { Body, Controller, Get, Path, Post, Route } from "tsoa";
import { Todo } from "../models/todo";

@Route("todos")  // Base path for all endpoints
export class TodoController extends Controller {
  
  @Get("/")  // GET /todos
  public async listTodos(): Promise<Todo[]> {
    return todos;
  }

  @Get("/{id}")  // GET /todos/:id
  public async getTodo(@Path() id: number): Promise<Todo | null> {
    return todos.find((t) => t.id === id) || null;
  }

  @Post("/")  // POST /todos
  public async createTodo(@Body() body: { title: string }): Promise<Todo> {
    const newTodo: Todo = {
      id: todos.length + 1,
      title: body.title,
      completed: false,
    };
    todos.push(newTodo);
    return newTodo;
  }
}
```

**Key Decorators:**
- `@Route("path")` - Base path for controller
- `@Get()`, `@Post()`, `@Put()`, `@Delete()` - HTTP methods
- `@Path()` - URL path parameters
- `@Body()` - Request body
- `@Query()` - Query parameters
- `@Header()` - Request headers

### 3. Configure TSOA

```json
// tsoa.json
{
  "entryFile": "src/server.ts",
  "controllerPathGlobs": ["src/controllers/**/*.ts"],
  
  "spec": {
    "specVersion": 3,
    "outputDirectory": "public",
    "specFileBaseName": "openapi"
  },
  
  "routes": {
    "routesDir": "src",
    "middleware": "express"
  }
}
```

### 4. Generate Routes and OpenAPI Spec

```bash
# Generate OpenAPI spec (public/openapi.json)
bunx tsoa spec

# Generate Express routes (src/routes.ts)
bunx tsoa routes
```

TSOA scans your controllers and generates:
- **`public/openapi.json`** - Full OpenAPI 3.0 specification
- **`src/routes.ts`** - Express route registration code

### 5. Use Generated Routes in Express

```typescript
// src/server.ts
import express from "express";
import swaggerUi from "swagger-ui-express";
import { RegisterRoutes } from "./routes";  // Auto-generated

const app = express();
app.use(express.json());

// Register all TSOA routes
RegisterRoutes(app);

// Serve Swagger UI
const openapi = require("../public/openapi.json");
app.use("/docs", swaggerUi.serve, swaggerUi.setup(openapi));

app.listen(3000, () => console.log("Server running on http://localhost:3000"));
```

---

## Project Structure

```
tsoa-todo/
├── src/
│   ├── server.ts              # Express server setup
│   ├── routes.ts              # ⚡ Auto-generated by TSOA
│   ├── controllers/
│   │   └── todo.controller.ts # Decorated controller classes
│   └── models/
│       └── todo.ts            # TypeScript interfaces
│
├── public/
│   └── openapi.json           # ⚡ Auto-generated OpenAPI spec
│
├── tsoa.json                  # TSOA configuration
├── tsconfig.json
└── package.json
```

---

## Quick Start

```bash
# Install dependencies
bun install

# Generate routes and OpenAPI spec
bunx tsoa spec
bunx tsoa routes

# Start server
bun run start
```

**Access the API:**
- API: `http://localhost:3000/todos`
- Swagger UI: `http://localhost:3000/docs`
- OpenAPI Spec: `http://localhost:3000/public/openapi.json`

---

## Example API Requests

```bash
# List all todos
curl http://localhost:3000/todos

# Get specific todo
curl http://localhost:3000/todos/1

# Create new todo
curl -X POST http://localhost:3000/todos \
  -H "Content-Type: application/json" \
  -d '{"title": "Learn TSOA"}'
```

---

## Why Use TSOA?

✅ **Single Source of Truth** - TypeScript types = API docs  
✅ **No Manual Docs** - OpenAPI generated from code  
✅ **Type Safety** - Runtime validation matches compile-time types  
✅ **Auto-completion** - Full IDE support for API development  
✅ **Standards-Based** - Generates valid OpenAPI 3.0 specs  

---

## Development Workflow

1. Write TypeScript controller with decorators
2. Run `bunx tsoa spec && bunx tsoa routes`
3. OpenAPI spec and routes auto-update
4. Swagger UI reflects changes immediately

No manual route registration. No separate API documentation. Just TypeScript.